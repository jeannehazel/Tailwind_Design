/* -*- Mode: js; js-indent-level: 2; -*- */
/*
 * Copyright 2011 Mozilla Foundation and contributors
 * Licensed under the New BSD license. See LICENSE or:
 * http://opensource.org/licenses/BSD-3-Clause
 */

/**
 * This is a helper function for getting values from parameter/options
 * objects.
 *
 * @param args The object we are extracting values from
 * @param name The name of the property we are getting.
 * @param defaultValue An optional value to return if the property is missing
 * from the object. If this is not specified and the property is missing, an
 * error will be thrown.
 */
function getArg(aArgs, aName, aDefaultValue) {
  if (aName in aArgs) {
    return aArgs[aName];
  } else if (arguments.length === 3) {
    return aDefaultValue;
  } else {
    throw new Error('"' + aName + '" is a required argument.');
  }
}
exports.getArg = getArg;

var urlRegexp = /^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/;
var dataUrlRegexp = /^data:.+\,.+$/;

function urlParse(aUrl) {
  var match = aUrl.match(urlRegexp);
  if (!match) {
    return null;
  }
  return {
    scheme: match[1],
    auth: match[2],
    host: match[3],
    port: match[4],
    path: match[5]
  };
}
exports.urlParse = urlParse;

function urlGenerate(aParsedUrl) {
  var url = '';
  if (aParsedUrl.scheme) {
    url += aParsedUrl.scheme + ':';
  }
  url += '//';
  if (aParsedUrl.auth) {
    url += aParsedUrl.auth + '@';
  }
  if (aParsedUrl.host) {
    url += aParsedUrl.host;
  }
  if (aParsedUrl.port) {
    url += ":" + aParsedUrl.port
  }
  if (aParsedUrl.path) {
    url += aParsedUrl.path;
  }
  return url;
}
exports.urlGenerate = urlGenerate;

var MAX_CACHED_INPUTS = 32;

/**
 * Takes some function `f(input) -> result` and returns a memoized version of
 * `f`.
 *
 * We keep at most `MAX_CACHED_INPUTS` memoized results of `f` alive. The
 * memoization is a dumb-simple, linear least-recently-used cache.
 */
function lruMemoize(f) {
  var cache = [];

  return function(input) {
    for (var i = 0; i < cache.length; i++) {
      if (cache[i].input === input) {
        var temp = cache[0];
        cache[0] = cache[i];
        cache[i] = temp;
        return cache[0].result;
      }
    }

    var result = f(input);

    cache.unshift({
      input,
      result,
    });

    if (cache.length > MAX_CACHED_INPUTS) {
      cache.pop();
    }

    return result;
  };
}

/**
 * Normalizes a path, or the path portion of a URL:
 *
 * - Replaces consecutive slashes with one slash.
 * - Removes unnecessary '.' parts.
 * - Removes unnecessary '<dir>/..' parts.
 *
 * Based on code in the Node.js 'path' core module.
 *
 * @param aPath The path or url to normalize.
 */
var normalize = lruMemoize(function normalize(aPath) {
  var path = aPath;
  var url = urlParse(aPath);
  if (url) {
    if (!url.path) {
      return aPath;
    }
    path = url.path;
  }
  var isAbsolute = exports.isAbsolute(path);
  // Split the path into parts between `/` characters. This is much faster than
  // using `.split(/\/+/g)`.
  var parts = [];
  var start = 0;
  var i = 0;
  while (true) {
    start = i;
    i = path.indexOf("/", start);
    if (i === -1) {
      parts.push(path.slice(start));
      break;
    } else {
      parts.push(path.slice(start, i));
      while (i < path.length && path[i] === "/") {
        i++;
      }
    }
  }

  for (var part, up = 0, i = parts.length - 1; i >= 0; i--) {
    part = parts[i];
    if (part === '.') {
      parts.splice(i, 1);
    } else if (part === '..') {
      up++;
    } else if (up > 0) {
      if (part === '') {
        // The first part is blank if the path is absolute. Trying to go
        // above the root is a no-op. Therefore we can remove all '..' parts
        // directly after the root.
        parts.splice(i + 1, up);
        up = 0;
      } else {
        parts.splice(i, 2);
        up--;
      }
    }
  }
  path = parts.join('/');

  if (path === '') {
    path = isAbsolute ? '/' : '.';
  }

  if (url) {
    url.path = path;
    return urlGenerate(url);
  }
  return path;
});
exports.normalize = normalize;

/**
 * Joins two paths/URLs.
 *
 * @param aRoot The root path or URL.
 * @param aPath The path or URL to be joined with the root.
 *
 * - If aPath is a URL or a data URI, aPath is returned, unless aPath is a
 *   scheme-relative URL: Then the scheme of aRoot, if any, is prepended
 *   first.
 * - Otherwise aPath is a path. If aRoot is a URL, then its path portion
 *   is updated with the result and aRoot is returned. Otherwise the result
 *   is returned.
 *   - If aPath is absolute, the result is aPath.
 *   - Otherwise the two paths are joined with a slash.
 * - Joining for example 'http://' and 'www.example.com' is also supported.
 */
function join(aRoot, aPath) {
  if (aRoot === "") {
    aRoot = ".";
  }
  if (aPath === "") {
    aPath = ".";
  }
  var aPathUrl = urlParse(aPath);
  var aRootUrl = urlParse(aRoot);
  if (aRootUrl) {
    aRoot = aRootUrl.path || '/';
  }

  // `join(foo, '//www.example.org')`
  if (aPathUrl && !aPathUrl.scheme) {
    if (aRootUrl) {
      aPathUrl.scheme = aRootUrl.scheme;
    }
    return urlGenerate(aPathUrl);
  }

  if (aPathUrl || aPath.match(dataUrlRegexp)) {
    return aPath;
  }

  // `join('http://', 'www.example.com')`
  if (aRootUrl && !aRootUrl.host && !aRootUrl.path) {
    aRootUrl.host = aPath;
    return urlGenerate(aRootUrl);
  }

  var joined = aPath.charAt(0) === '/'
    ? aPath
    : normalize(aRoot.replace(/\/+$/, '') + '/' + aPath);

  if (aRootUrl) {
    aRootUrl.path = joined;
    return urlGenerate(aRootUrl);
  }
  return joined;
}
exports.join = join;

exports.isAbsolute = function (aPath) {
  return aPath.charAt(0) === '/' || urlRegexp.test(aPath);
};

/**
 * Make a path relative to a URL or another path.
 *
 * @param aRoot The root path or URL.
 * @param aPath The path or URL to be made relative to aRoot.
 */
function relative(aRoot, aPath) {
  if (aRoot === "") {
    aRoot = ".";
  }

  aRoot = aRoot.replace(/\/$/, '');

  // It is possible for the path to be above the root. In this case, simply
  // checking whether the root is a prefix of the path won't work. Instead, we
  // need to remove components from the root one by one, until either we find
  // a prefix that fits, or we run out of components to remove.
  var level = 0;
  while (aPath.indexOf(aRoot + '/') !== 0) {
    var index = aRoot.lastIndexOf("/");
    if (index < 0) {
      return aPath;
    }

    // If the only part of the root that is left is the scheme (i.e. http://,
    // file:///, etc.), one or more slashes (/), or simply nothing at all, we
    // have exhausted all components, so the path is not relative to the root.
    aRoot = aRoot.slice(0, index);
    if (aRoot.match(/^([^\/]+:\/)?\/*$/)) {
      return aPath;
    }

    ++level;
  }

  // Make sure we add a "../" for each component we removed from the root.
  return Array(level + 1).join("../") + aPath.substr(aRoot.length + 1);
}
exports.relative = relative;

var supportsNullProto = (function () {
  var obj = Object.create(null);
  return !('__proto__' in obj);
}());

function identity (s) {
  return s;
}

/**
 * Because behavior goes wacky when you set `__proto__` on objects, we
 * have to prefix all the strings in our set with an arbitrary character.
 *
 * See https://github.com/mozilla/source-map/pull/31 and
 * https://github.com/mozilla/source-map/issues/30
 *
 * @param String aStr
 */
function toSetString(aStr) {
  if (isProtoString(aStr)) {
    return '$' + aStr;
  }

  return aStr;
}
exports.toSetString = supportsNullProto ? identity : toSetString;

function fromSetString(aStr) {
  if (isProtoString(aStr)) {
    return aStr.slice(1);
  }

  return aStr;
}
exports.fromSetString = supportsNullProto ? identity : fromSetString;

function isProtoString(s) {
  if (!s) {
    return false;
  }

  var length = s.length;

  if (length < 9 /* "__proto__".length */) {
    return false;
  }

  if (s.charCodeAt(length - 1) !== 95  /* '_' */ ||
      s.charCodeAt(length - 2) !== 95  /* '_' */ ||
      s.charCodeAt(length - 3) !== 111 /* 'o' */ ||
      s.charCodeAt(length - 4) !== 116 /* 't' */ ||
      s.charCodeAt(length - 5) !== 111 /* 'o' */ ‰PNG

   IHDR   k   k   GaŒ>   gAMA  ±üa   sRGB ®Îé  PLTE    ®ï ¯ñ ­î ®ğ ®ğ ¯ğ ¯ğ ®î ¯ğ ®î ¯ï ¯ğ ®í ­î ®ñ ¯í ¾ÿ ©â ¯ï °ğ |ÿ ­î ®î ¯î ¬î ¯ò ¯ï ­î ¯ğ °ñ ®ğ ®ï ¯ï ¯ğ ®ñ ¯ò ¯ï °ñ ­î °ñ ®ï ­ğ ®ğ ®ğ ­ï ¯ğ ¹ş ÿÿ ªé ±ÿ ±ï °î ´÷ ¬ñ ©ï ®í ¬î ©ş °ñ ±ğ ¹ç ¯ó ±ó ­î ¯ï ²ò ±ñ ´ğ »î ­ñ ®î ®ñ ­ó ©æ ­ì ­í ¯ï «í °õ °ò ±ó °ò ±ó ¯ğ ®í ®ñ °ñ °ò ªì ±ó ³õ ²ô ¯ò ³ì ­ï ­ï °ó ­ï ­ğ °ğ ±ó ¯ñ ®ğ °ñ ±ó ®ñ °ò ®î ¯ï °ò ­î ¯ğ ­î ¯ï °ğ ±ğ ­î °ğ ¯î ¯ğ ­ï ²ô ²ò ´õ ­ï «ì ³õ ±ô ±ó ²ô °ì ­î °ò ²ô °ñ ¯ñ ¯ï ­î ­ï °ò ²õ °ñ ¯ğ ®î ±ò ´÷ ²å ®ğ ®ï ®ï ¼ÿ ­î µù ¶ú ¶û ®î ®ğ ¯ñ ·ü ²ô °ò ¹ı ´ø ¸ı ±ó ³õ µø ¹ş »ÿ ´÷ ²õ ±ò ¯ğ ¯ï ±ôµ¹_±   –tRNS d\]gXfenY^oFh»^YOWm>l=bbZimkaRl[c_`Ûıõjh5†‰
	 =!$ gxMx
,*M;^m©H+€s€ğïµßtnaæ]Üá`ğvcØµZZ­ôòq×‘}~¯Ó×ıir®X÷iŸ¯wiñ6¥ôõ¦)Õ¸Ğ¸…’Ô’)Ïˆ¼½xiğºnÕ  ‹IDAThŞí˜çWÓP‡mš4£SËŞ”.¦" .@"Ó{á,E'¸D×Mš´IÊ^ê¿h+Gx„Ö$½Ï¹Ïé§æ×>'7ÉÍû¾ëÖ!@ ˆHqI)›Ö[õt¶© ¤8v¢ŠÊ)I¼Ş|s~o##)eGeELLµ‰©T&®sc4qËv‹ 1·Ï¤Rk57mH6PfC¸®¾éï³¼µôõ¿¹ê"™2$oĞVµÅzw^Ğw^:wy‘„ğgñò¹KúNüˆu‹†¦øÄ„t2‡éèñJÁ X&\¼=L™¯ÙúÙ†,bøšÏ'.K¦åée¥èó]&²F»Fë¸1"±³/f|á—çXIÌÈ%vNá›yy#©¸Z¨ÖÇ%i‡OL‰~ öôÁû{šÚšö¾;xš ğ‹S'§‘	qëÕ«6Ù)’n>Àû7;?ô~ß/‡ö=šŸå€Ÿ?ĞL“”}“jW©‘Lk}2ÉùìÉS¿ßñ§N²?7ù¸54–ªU•í1`-û'9n‰}Ôø‡ãOÙ%›Üß‚ö”©¼X5éY)‡x“'v®Ù9!s(%+½Fİ%«6’„e
€é‰­«f¶NL0e!HcµUÏ)œA€İ¶Fj âLan¨SáJ¦œVÏÏ±õkÆêYÎïóXT²rÕö£æ‹£¡GxöØî5s»Í†êÑ‹æ£Û»ª(şzÈ5<Bğø|Èu]¯£ª»ve2]ŞÏ€1ùŠŸ½]Læ.¥ªÍ©8Ñ-Àâ£8€ÔMà©›ºÊ“t.Ï¯<ˆıpE—.©\¡« Ã}óvÌ"{~oßtg(t™XÑbh	Û£È¶‡q±s˜º²óè»<ø"Eó{“ôğwé¼l….úí ‚7E‘}}#„{¶;´B—>ßfÀ×Ü3QdÏä~‚Å–¯WèbÌô¸ ämQdÛd ŒÓfæ?8/˜×æ}óù‚¹oüÅ~ø@í~sŸ‡ùş‚ú^×#Q×#ªê˜uÔúfİµ‡Ù§@í¿Vö•cWö•cÚö•«öË÷µï—¡Î~Ì7
W™oj9ß€:·:Z1g+
ÏÙ>õõÅjÎu~w.úâ’ÁŸóŞÁXÎ{@ Dd¾Ôµg?q    IEND®B`‚                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ‰PNG

   IHDR         çı0  öIDATxÚíµ’õFEÕ—şß©ùEÌ/`ÎMoáÈ/c¶s3†¦Ğ˜3ÓÛ¦¨vm•úÓ¨ï´¾Z«jW·¤éÖªÓ§;                       8©j 9
Y&³:v“ÎQõ§\(¨H¹,Év »Sf;ùüF¤&äAFÅø_äÿuŸÇˆ%-^õb¤1õæ++“¹V1ÉrŸŠ“%!N=iÆ„Ñ¬İ8¡'*–¦7ïäœ{®*ò Ì§6Ä*dsMïz\H_uTŒùåAœTÔç!4ÒcÈ(ó9¤ñHÅ©/âxi$N/Œ%ÅJ¥9ˆ“ÌÜ÷4Ã²lu®ÇÓbÄ“J$)­8y~¹gty)4ş¼È_÷â©°*J“„ÈKªD›åT›ñfø†ç^¿á¢+¯²k¯Ş|ù¾7î¹õdß“%‹X"Q›¬ºe ò$#ÎV¤iŠ‹¯»åñ¨Rã_EÄñÂ„4‘ÖÙöâäé“§^µÑ¾f/<òÌ?‘ãáœ‚ôA¾òL’q’™û>Gåiß@ûç¬ '¢»ªiÜşèÿD‡3AiÒÌËâ”mÉ#í³QiT˜U‡]•ùæ¦,W­c¿Â,©-G²şüÃº–S_Äñ%{¬Qn•få¤a©ª&‘6”‘æ1U¦|G•§Ö¶V›J1â$ÆÏ#í“F£,UJZ¬8åÒ$Ä©ı3Èíc›àº² N-ùíSé'UyßöIˆÃ‹n8ëe	qRòPu¼8€ ˆƒ<ˆS@@@@@ ÄÄÄÄ@@œ/>ú¾å € q q q q q  q q q q çów>n9ˆ€8€8€8€8€80q`Ò N:Pˆs>¿à¹Îı#N>ÅµŒücPq²dI/~>ìˆ“Ï“>çPø<qê’#‡›FîÕWËY$Bœ<VæûãåŸ¾Õµ'
»ªêˆ4’…Uœú}â¨4¶A>DZçP°\eÄ™]/Lä¤kŸ½ÜóÁËãŸq&!Âˆ4‘Ö9y²—‡]UÕşF¤YFÅ‰{yz©Ç/Sû…‰sR·×AœÜ­4‘ß>{ÿ®Q~ıô‡Eßë­Ë“p_«8^EÖ‘M/Û¿³ûgŒ\ã¦7®#«ÈÔzŸÿ‰î’TâäÏ^şˆñ·˜Çõ~ßã«P‹­"tÒÑÌ%~IëeoògaöwîÅÅö:1
S¥Ak”çF½çO/?*Éb‰Uš9EA½PZÚMµ	y´ÒÈqéyL¥ò'„‰1mËg*ˆHxa:İ²KöÓã«T¡T'’z®jCsl«4µ+“µ4Á®^©˜3íö#_ <8iôıŒ<qf“'F/P2ÂÄ¨cqü×˜d‰äºdÎÆq¼<ÉÈ!¦OšQœÎÊ£“ù:Î‘äqdn¶íó=¿ï­|fŞyi§Ò=zD{]F%Mÿõ?ºH_xi§²<£Bõ¨³T•ÿ¤¢qjÉ3,WXª¬L#"GÄ)_bfh€kÈ”‹—<Ä9ş}
“*ËR~îèÒ@*ÈêŒ“Fsf@Zh ™Ù–                   À_¸†Â·DtŸğ    IEND®B`‚                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            